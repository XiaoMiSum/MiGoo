name: 高阶 - 函数与hook
config:
  variables:
    var: test
  beforeClass:
    - __hook1(beforeClass)
  request:
    url: http://migoo.xyz/api/login
    method: post
    headers:
      Content-Type: application/json
case:
  - title: 未注册的用户登录
    setUp:
      userName: migoo1
      password: __getPwd(${userName})
    before:
      - __hook1(before)
    after:
      - __hook2(after)
    body:
      userName: ${userName}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: 411, types: eq}
      - {check: body.data, expect: null, types: blank }
  - title: 密码错误登录
    setUp:
      userName: migoo
      password: 123456
    before:
      - __hook1(before)
    after:
      - __hook2(after)
    body:
      userName: ${userName}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: __setValue(411), types: eq}
      - {check: body.data, expect: null, types: isNull }
  - title: 正确的用户名密码登录
    setUp:
      userName: migoo
      password: 123456qq
    before:
      - __hook1(before)
    after:
      - __hook2(after)
    body:
      userName: ${userName}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: 200, types: eq}
      - {check: $.data.token, expect: null, types: isNotNull }