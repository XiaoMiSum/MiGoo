name: 高阶 - 函数与hook
config:
  variables:
    var: test
  beforeClass:
    - __hook(beforeClass)
  request:
    url: http://migoo.xyz/api/login
    method: post
    # restful: 1/0  t/f  T/F  y/n  Y/N  yes/no  YES/NO  true/false  TRUE/FALSE
    # 如果在 用例中也设置该参数，以用例中的设置为准
    restful: 0
    headers:
      Content-Type: application/json
case:
  - title: 未注册的用户登录
    restful: 1
    setUp:
      user: migoo1
      password: __getPwd(${user})
    before:
      - __hook(before)
    after:
      - __hook(after)
    # query: restful风格的 get\delete 请求时，url路径中的参数可在该属性中配置，使用方式与 body一样
    # 特别注意 当delete请求 url路径含有参数，并携带body时，url路径中的参数必须使用 query来配置
    # url示例：http://127.0.0.1/user/{id}
    #query:
    # user: ${user}
    # password: ${password}
    body:
      user: ${user}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: 411, types: eq}
      - {check: body.data, expect: null, types: blank }
  - title: 密码错误登录
    setUp:
      user: migoo
      password: 123456
    before:
      - __hook(before)
    after:
      - __hook(after)
    restful: 1
    body:
      user: ${user}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: __setValue(411), types: eq}
      - {check: body.data, expect: null, types: isNull }
  - title: 正确的用户名密码登录
    restful: 1
    setUp:
      user: migoo
      password: 123456qq
    before:
      - __hook(before)
    after:
      - __hook(after)
    body:
      user: ${user}
      password: ${password}
    validate:
      - {check: status, expect: 200, types: ==}
      - {check: $.status, expect: 200, types: eq}
      - {check: body.token, expect: null, types: isNotNull }